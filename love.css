/* === Base canvas === */
html, body{
  margin:0;
  background: rgb(223,118,209);
  overflow: hidden;           /* mobile overflow hardening */
  height: 100dvh;
  overscroll-behavior: none;
}

/* === Orbiting hearts === */
.heart-cloud{
  position:absolute; top:50%; left:50%;
  transform:translate(-50%,-50%);
  pointer-events:none;
}
.heart{
  width:16px; height:16px; position:absolute;
  animation: orbit 16s linear infinite reverse,
             pulse 2s ease-in-out infinite,
             colorFade 10s linear infinite;
  offset-path:path("M 0 -80 C -53 -120 -128 -94 -128 -14 C -128 66 -66 128 0 160 C 66 128 128 66 128 -14 C 128 -94 53 -120 0 -80 Z");
  -webkit-offset-path:path("M 0 -80 C -53 -120 -128 -94 -128 -14 C -128 66 -66 128 0 160 C 66 128 128 66 128 -14 C 128 -94 53 -120 0 -80 Z");
  offset-rotate:0deg;
}
.big-heart{
  width:24px; height:24px;
  animation: orbit 20s linear infinite,
             pulse 2s ease-in-out infinite,
             colorFade 10s linear infinite;
  offset-path:path("M 0 -100 C -67 -150 -160 -117 -160 -17 C -160 83 -83 157 0 200 C 83 157 160 83 160 -17 C 160 -117 67 -150 0 -100 Z");
  -webkit-offset-path:path("M 0 -100 C -67 -150 -160 -117 -160 -17 C -160 83 -83 157 0 200 C 83 157 160 83 160 -17 C 160 -117 67 -150 0 -100 Z");
  offset-rotate:0deg;
}

/* === Love note === */
.fade-in{ opacity:0; animation:fadeIn .5s forwards; }
.love-note{
  position:absolute; top:54%; left:50%;
  transform:translate(-50%,-50%);
  z-index:5; pointer-events:none; width:195px; text-align:center;
}
.love-note .float{ animation:floatY 4s ease-in-out infinite; will-change:transform; }
.love-note .line{
  color:#fff; -webkit-text-stroke:.5px rgba(0,0,0,.18);
  text-shadow:0 1px 0 rgba(0,0,0,.10), 0 1px 4px rgba(255,255,255,.30);
  line-height:1.1; margin:2px 0;
}
.love-note .line{ font-size:clamp(18px,4.05vw,33px); }
.love-note .plus{ font-size:clamp(18px,4vw,30px); margin:0 0 1px; text-shadow:0 1px 0 rgba(0,0,0,.15), 0 1px 4px rgba(255,255,255,.35); }
.love-note .forever{ font-size:clamp(19.5px,4.5vw,36px); letter-spacing:.5px; }
.font-greatvibes{font-family:'Great Vibes',cursive}
.font-playfair{font-family:'Playfair Display',serif}
.font-pacifico{font-family:'Pacifico',cursive}
.font-dancingscript{font-family:'Dancing Script',cursive}
.font-parisienne{font-family:'Parisienne',cursive}
@media (max-width:430px){ .love-note{ width:165px; } }
@keyframes floatY{0%,100%{transform:translateY(-3px)}50%{transform:translateY(3px)}}

/* === Bubble canvas & affirmations === */
#bubble-canvas{
  position:fixed !important;
  inset:0;
  width:100vw;
  height:100dvh;
  pointer-events:auto;
  z-index:10;
  overflow:hidden;
  touch-action: manipulation;
}
.affirmation{
  position: fixed;                /* off-screen text never changes layout */
  font-size:1.2rem; color:#fff;
  text-shadow:0 0 4px rgba(0,0,0,.5);
  pointer-events:none;
  animation:fadeUp 1.2s ease-out forwards;
  white-space:nowrap;
  contain: layout paint;
}
@keyframes fadeUp{0%{transform:translateY(0);opacity:1}100%{transform:translateY(-40px);opacity:0}}

/* === Generic animations === */
@keyframes fadeIn{0%{opacity:0}100%{opacity:1}}
@keyframes colorFade{0%{filter:hue-rotate(0)}100%{filter:hue-rotate(360deg)}}
@keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.25)}}
@keyframes orbit{to{offset-distance:100%}}
@-webkit-keyframes orbit{to{-webkit-offset-distance:100%}}

/* === Side menu (opens to the right of the heart) === */
.side-menu{
  position:fixed;
  top:calc(16px + env(safe-area-inset-top,0));
  left:calc(16px + env(safe-area-inset-left,0));
  z-index:1200;
  display:flex; align-items:flex-start; gap:10px;
}
.menu-toggle{
  border:0; cursor:pointer; font-size:18px; line-height:1;
  padding:10px 12px; border-radius:12px; color:#fff;
  background:rgba(255,255,255,.16);
  box-shadow:0 6px 18px rgba(0,0,0,.18), inset 0 1px rgba(255,255,255,.4);
  backdrop-filter:blur(8px);
}
.menu-inner{
  position:absolute;
  top:0;
  left:56px;                /* open to the right of the heart */
  width:220px;
  max-height:70vh;
  overflow:auto;
  padding:14px 14px 10px;
  border-radius:16px;
  border:1px solid rgba(255,255,255,.55);
  background:rgba(255,255,255,.18);
  box-shadow:0 12px 28px rgba(0,0,0,.25);
  backdrop-filter:blur(10px);
  transform-origin:left top;
  transition:opacity .25s ease, transform .25s ease;
  pointer-events:auto;
}
.side-menu:not(.open) .menu-inner{opacity:0; pointer-events:none; transform:scale(.96)}
.menu-link{
  display:block; padding:8px 10px; margin:6px 0; border-radius:10px;
  text-decoration:none; font-weight:600; color:#fff;
  text-shadow:0 2px 10px rgba(0,0,0,.25);
  background:rgba(255,255,255,.08); border:1px solid rgba(255,255,255,.4);
}
.menu-link:hover{ background:rgba(255,255,255,.16) }

/* === Control panel — TOP CENTER (desktop), BOTTOM CENTER (mobile) === */
.control-panel.glassy{
  position: fixed;
  top: calc(16px + env(safe-area-inset-top, 0));
  left: 50%;
  transform: translateX(-50%);
  z-index: 1100;

  display: flex;
  gap: 16px;
  align-items: center;
  padding: 10px 14px;
  border-radius: 16px;
  border:1px solid rgba(255,255,255,.55);
  background:rgba(255,255,255,.18);
  box-shadow:0 12px 28px rgba(0,0,0,.25);
  backdrop-filter: blur(10px);
}
.control-row{
  display:flex; flex-direction:row; align-items:center; gap:8px;
}
.control-row .gradient-text{ white-space: nowrap; }

/* labels */
.gradient-text{
  font-weight:700; letter-spacing:.3px;
  background:linear-gradient(90deg,#fff 0%,#fe9afc 25%,#ffe47b 50%,#ff85f7 75%,#fff 100%);
  background-size:300% 100%;
  -webkit-background-clip:text; background-clip:text;
  -webkit-text-fill-color:transparent;
  animation:shimmer 6s linear infinite;
  text-shadow:0 2px 10px rgba(0,0,0,.25);
}
@keyframes shimmer{0%{background-position:0% 0}100%{background-position:300% 0}}

/* selects */
.pretty-select{
  appearance:none; -webkit-appearance:none; -moz-appearance:none;
  padding:8px 12px; border-radius:10px;
  border:1px solid rgba(255,255,255,.6);
  background:rgba(255,255,255,.22);
  color:#2b124b; font-weight:600;
  box-shadow:inset 0 1px rgba(255,255,255,.5);
  outline:none; backdrop-filter:blur(8px);
  background-image:
    linear-gradient(transparent,transparent),
    url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="14" height="10" viewBox="0 0 14 10"><path d="M1 1l6 6 6-6" stroke="%23555" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"/></svg>');
  background-repeat:no-repeat; background-position:right 10px center;
  padding-right:34px;
}
.pretty-select:focus{ box-shadow:0 0 0 2px rgba(255,255,255,.6), inset 0 1px rgba(255,255,255,.5); }

/* Make sure UI is interactable over canvas */
.side-menu, .control-panel, .music-player{ pointer-events:auto; }

/* === Music player (TOP RIGHT) === */
:root{
  --vol:.5;                          /* updated by JS */
  --vol-accent-1:#ffe47b;            /* yellow */
  --vol-accent-2:#ff85f7;            /* pink */
  --vol-track:rgba(255,255,255,.22); /* glass track */
  --vol-border:rgba(255,255,255,.6);
}

.music-player{
  position: fixed;
  top:  calc(16px + env(safe-area-inset-top,0));
  right:calc(16px + env(safe-area-inset-right,0));
  z-index: 1200;

  display:flex; align-items:center; gap:8px;
  padding: 8px 12px;
  border-radius: 12px;
  border:1px solid rgba(255,255,255,.55);
  background: rgba(255,255,255,.18);
  box-shadow: 0 12px 28px rgba(0,0,0,.25);
  backdrop-filter: blur(10px);
}

.music-player button{
  background:none; border:none; font-size:16px; color:#fff; cursor:pointer;
}

/* Horizontal slider (desktop default) */
.music-player input[type="range"]{
  -webkit-appearance:none; appearance:none;
  width:160px; height:12px; border-radius:999px;
  border:1px solid var(--vol-border);
  background:
    linear-gradient(
      to right,
      var(--vol-accent-1) 0%,
      var(--vol-accent-2) calc(var(--vol)*100%),
      var(--vol-track)    calc(var(--vol)*100%),
      var(--vol-track)    100%
    );
  box-shadow: inset 0 1px rgba(255,255,255,.55), 0 6px 16px rgba(0,0,0,.18);
  outline:none; cursor:pointer; transition:box-shadow .2s ease;
}
.music-player input[type="range"]:focus{
  box-shadow:0 0 0 2px rgba(255,255,255,.65), inset 0 1px rgba(255,255,255,.55), 0 6px 16px rgba(0,0,0,.18);
}
.music-player input[type="range"]::-webkit-slider-runnable-track{ height:12px; background:transparent; border-radius:999px; }
.music-player input[type="range"]::-webkit-slider-thumb{
  -webkit-appearance:none; width:18px; height:18px; margin-top:-3px; border-radius:50%;
  border:1px solid rgba(0,0,0,.22);
  background:linear-gradient(135deg,#ffffff,#ffe47b);
  box-shadow:0 0 0 4px rgba(255,255,255,.35), 0 4px 12px rgba(0,0,0,.28);
  transition:transform .12s ease;
}
.music-player input[type="range"]::-webkit-slider-thumb:hover{ transform:scale(1.06); }
.music-player input[type="range"]::-moz-range-track{
  height:12px; background:var(--vol-track); border:1px solid var(--vol-border); border-radius:999px;
}
.music-player input[type="range"]::-moz-range-progress{
  height:12px; background:linear-gradient(90deg,var(--vol-accent-1),var(--vol-accent-2)); border-radius:999px;
}
.music-player input[type="range"]::-moz-range-thumb{
  width:18px; height:18px; border-radius:50%;
  border:1px solid rgba(0,0,0,.22);
  background:linear-gradient(135deg,#ffffff,#ffe47b);
  box-shadow:0 0 0 4px rgba(255,255,255,.35), 0 4px 12px rgba(0,0,0,.28);
  transition:transform .12s ease;
}
.music-player input[type="range"]::-moz-range-thumb:hover{ transform:scale(1.06); }

/* === MOBILE (≤768px)
     - Player stays top-right, switches to vertical column
     - Slider turns vertical AND container fits it (tall, narrow)
     - Control panel moves to bottom-center
================================================================ */
@media (max-width:768px){
  /* Player becomes a tall, narrow glass card that fits the vertical slider */
  .music-player{
    flex-direction: column;
    align-items: center;
    gap: 10px;
    padding: 12px;
    width: auto;
    min-width: 56px;              /* narrow, enough for thumb halo */
  }

  /* KEY: set intrinsic layout size to tall/narrow BEFORE rotation
     so the glass rectangle wraps perfectly */
  #volume-slider{
    -webkit-appearance:none; appearance:none;
    width: 12px;                  /* narrow layout width */
    height: 180px;                /* tall layout height */
    transform-origin: 50% 50%;
    margin: 0;                    /* no extra offsets */
  }
  #volume-slider::-webkit-slider-runnable-track{ height:12px; }
  #volume-slider::-webkit-slider-thumb{ margin-top:0; }

  /* Control panel to bottom-center on small screens */
  .control-panel.glassy{
    top: auto;
    bottom: calc(16px + env(safe-area-inset-bottom, 0));
    left: 50%;
    transform: translateX(-50%);
    gap: 12px;
    padding: 8px 10px;
    flex-wrap: wrap;
    row-gap: 8px;
  }
}

/* Extra small tweak */
@media (max-width:560px){
  #volume-slider{ height: 160px; }
}

/* Mobile: hide the volume slider, keep a compact player card top-right */
@media (max-width: 768px){
  #volume-slider{
    display: none !important;
  }
  .music-player{
    /* go back to a small horizontal card with just the play/pause button */
    flex-direction: row !important;
    align-items: center !important;
    gap: 8px !important;
    padding: 10px 12px !important;
    width: auto !important;
    min-width: 0 !important;
  }
}
